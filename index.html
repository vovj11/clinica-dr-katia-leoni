<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clinica Dra. Katia Leoni</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./style.css" />
  </head>

  <body class="bg-gray-100 text-gray-900">
    <div
      id="topo-sentinela"
      style="height: 1px; width: 1px; position: absolute; top: 0"
    ></div>

    <!-- Loader -->
    <div id="loader">
      <div class="flex flex-col items-center gap-2">
        <svg
          class="animate-spin h-8 w-8 text-blue-600"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8v8z"
          ></path>
        </svg>
        <span class="text-sm text-blue-600 font-medium"
          >Carregando catálogo...</span
        >
      </div>
    </div>

    <!-- Hero Section -->
    <section id="hero-section" class="relative min-h-[8rem]">
      <!-- Banner -->
      <img
        id="banner"
        src=""
        alt="Banner"
        class="w-full h-80 object-cover hidden brightness-50"
      />

      <!-- Fallback quando não há banner -->
      <div
        id="hero-fallback"
        class="w-full h-80 flex items-center justify-center text-center px-4 text-white"
      ></div>

      <!-- Logo, título e info -->
      <div
        class="absolute inset-0 flex flex-col items-center justify-center text-center px-4"
      >
        <img
          id="logo"
          src=""
          alt="Logo"
          class="w-20 h-20 rounded-full object-cover mb-3 border-4 border-white hidden"
        />
        <h1 id="header" class="text-3xl font-extrabold text-white"></h1>
        <p id="info" class="text-sm text-gray-200 mt-1"></p>
        <div id="endereco" class="mt-4"></div>
        <div
          id="status-loja"
          class="flex gap-2 mt-2 text-sm rounded-full px-2 py-1 text-white"
        ></div>
      </div>
    </section>

    <!-- Categorias em badges -->
    <div
      id="categorias"
      class="sticky top-0 z-20 px-4 py-3 max-w-6xl mx-auto flex gap-2 overflow-x-auto transition-all duration-300 whitespace-nowrap"
    ></div>

    <!-- Barra de pesquisa -->
    <div class="max-w-6xl mx-auto px-4 mt-6">
      <input
        type="text"
        id="searchInput"
        oninput="filtrarProdutos()"
        placeholder="Pesquisar..."
        class="w-full p-3 rounded-lg border"
      />
    </div>

    <!-- Main Produtos -->
    <main class="max-w-6xl mx-auto px-4 py-8">
      <div id="catalogo"></div>
    </main>

    <button
      id="btn-voltar-topo"
      class="fixed bottom-4 right-28 z-50 opacity-90 px-4 p-3 rounded-full shadow-lg hidden"
      onclick="scrollToTop()"
    >
      <i class="ph ph-arrow-up"></i>
    </button>

    <!-- Botão flutuante do carrinho -->
    <button
      onclick="abrirCarrinho(true)"
      id="btn-carrinho"
      class="fixed bottom-4 right-4 z-50 px-4 py-3 rounded-full shadow-lg flex items-center"
    >
      <i class="ph ph-phone-plus text-xl"></i>
      <span class="font-medium px-2">Solicitações</span>
      <span
        class="font-bold rounded-full w-6 h-6 flex items-center justify-center text-sm"
        id="cart-count"
        >0</span
      >
    </button>

    <!-- Modal de Complementos -->
    <div
      id="modal-complementos"
      class="hidden fixed inset-0 z-50 bg-black/40 flex items-center justify-center"
    >
      <div class="bg-white max-w-md w-full p-6 rounded-lg shadow-xl">
        <h2 class="text-xl font-bold mb-4" id="titulo-complemento">
          Escolha seus complementos
        </h2>
        <div
          id="complemento-lista"
          class="space-y-4 max-h-64 overflow-y-auto"
        ></div>

        <div class="mt-6 flex justify-between gap-2">
          <button
            onclick="fecharModalComplementos()"
            class="px-4 py-2 rounded bg-gray-200 hover:bg-gray-300"
          >
            Cancelar
          </button>
          <button
            onclick="confirmarComplementos()"
            class="px-4 py-2 rounded text-white"
            id="btn-confirmar-complementos"
          >
            Adicionar
          </button>
        </div>
      </div>
    </div>

    <!-- Modal Carrinho -->
    <div
      id="modal"
      class="hidden fixed inset-0 z-50 bg-black/40 flex items-center justify-center"
    >
      <div class="bg-white max-w-md w-full p-6 rounded-lg shadow-xl">
        <!-- Indicador de Etapas -->
        <div
          id="etapa-indicador"
          class="text-sm font-semibold mb-4 text-center"
        >
          Etapa 1 de 2
        </div>

        <!-- Etapa 1 -->
        <div id="step-1">
          <h2 id="cart-title" class="text-xl font-bold mb-4">
            Suas Solicitações:
          </h2>
          <div id="cart-list" class="space-y-2 max-h-64 overflow-y-auto"></div>
          <div class="mt-4">
            <label id="obs-label" class="block text-sm font-medium mb-1"
              >Conte-me o que sente:</label
            >
            <textarea
              id="obs"
              rows="4"
              class="w-full border border-gray-300 rounded p-2 text-sm resize-none"
              placeholder="Escreva o que está passando — vamos te ajudar a entender a melhor forma de cuidado. (opcional)"
              maxlength="1000"
            ></textarea>
          </div>
          <p id="total" class="mt-4 font-semibold"></p>
          <div class="mt-6 flex justify-end gap-2">
            <button
              onclick="fecharCarrinho()"
              class="px-4 py-2 rounded bg-gray-200 hover:bg-gray-300"
            >
              Fechar
            </button>
            <button
              onclick="avancarEtapa()"
              id="btn-avancar"
              class="px-4 py-2 rounded text-white"
            >
              Avançar
            </button>
          </div>
        </div>

        <!-- Etapa 2 -->
        <div id="step-2" class="hidden">
          <h2 class="text-xl font-bold mb-4">Seus Dados</h2>

          <label for="cliente_nome" class="block text-sm font-medium mb-1"
            >Nome <span class="text-red-500">*</span></label
          >
          <input
            type="text"
            id="cliente_nome"
            class="w-full border border-gray-300 rounded p-2 text-sm mb-3"
            placeholder="Insira seu nome e sobrenome"
          />

          <label class="block text-sm font-medium mb-1"
            >Preferência de atendimento
            <span class="text-red-500">*</span></label
          >
          <div class="flex gap-4 text-sm mb-3">
            <label>
              <input
                id="input-radio"
                type="radio"
                name="atendimento"
                value="presencial"
                checked
                onchange="toggleEndereco()"
              />
              Presencial
            </label>
            <label>
              <input
                id="input-radio"
                type="radio"
                name="atendimento"
                value="online"
                onchange="toggleEndereco()"
              />
              Online
            </label>
          </div>

          <label
            for="cliente_endereco"
            class="block text-sm font-medium mb-1 hidden"
            id="label-endereco"
            >Endereço <span class="text-red-500">*</span></label
          >
          <input
            type="text"
            id="cliente_endereco"
            class="w-full border border-gray-300 rounded p-2 text-sm mb-3 hidden"
            placeholder="Endereço completo"
          />

          <label for="cliente_pagamento" class="block text-sm font-medium mb-1">
            Forma de pagamento <span class="text-red-500">*</span>
          </label>
          <select
            id="cliente_pagamento"
            class="w-full border border-gray-300 rounded p-2 text-sm mb-4"
          >
            <option value="">Selecione...</option>
          </select>

          <!-- Campo de troco -->
          <div id="campo-troco" class="hidden mb-4">
            <label for="cliente_troco" class="block text-sm font-medium mb-1"
              >Troco para quanto?</label
            >
            <input
              type="text"
              id="cliente_troco"
              class="w-full border border-gray-300 rounded p-2 text-sm"
              placeholder="Ex: 100.00"
            />
          </div>

          <div class="flex justify-between gap-2">
            <button
              onclick="voltarEtapa()"
              class="px-4 py-2 rounded bg-gray-200 hover:bg-gray-300"
            >
              Voltar
            </button>
            <button
              onclick="enviarPedidoWhatsApp()"
              id="btn-enviar"
              class="px-4 py-2 rounded text-white"
            >
              <i class="ph ph-whatsapp-logo text-lg"></i> Enviar Pedido
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toasts -->
    <div id="toast-container" class="toast-container"></div>

    <script src="./main.js"></script>
    <script src="./cart.js"></script>
  </body>
</html>
